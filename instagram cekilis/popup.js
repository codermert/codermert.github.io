document.addEventListener("DOMContentLoaded",function(){function a(){const a=Math.floor(2e3*Math.random())+1e3;return new Promise(b=>setTimeout(b,a))}function b(a){for(var b=0;b<j.comments.length;b++)if(j.comments[b].username===a.username&&j.comments[b].text===a.text)return 0;return j.comments.push(a),w.insertAdjacentHTML("beforeend","<p><span class=\"font-semibold\">"+a.username+"</span>: "+a.text+"</p>"),1}function c(a){let b=2e3*a/6e4,c=Math.floor(b),d=Math.floor(60*(b-c));return 0<c?"Tahmini Süre: "+c+" dakika "+d+" saniye":"Tahmini Süre: "+d+" saniye"}function d(){switch(l){case"logged_in":if(n)return void g(n);t.style.display="none",u.parentElement.style.display="block",e();break;case"logged_out":u.innerHTML="<span class=\"circle danger\"></span> Lütfen Instagram'a giriş yapınız";break;default:u.innerHTML="<span class=\"circle warning\"></span> Carregando...";}}function e(){fetch("https://www.instagram.com/graphql/query/?query_hash=c9100bf9110dd6361671f113dd02e7d6&variables={\"user_id\":\""+i+"\",\"include_chaining\":false,\"include_reel\":true,\"include_suggested_users\":false,\"include_logged_out_extras\":false,\"include_highlight_reels\":false,\"include_related_profiles\":false}").then(a=>a.json()).then(a=>{let b=document.querySelector(".profile-pic"),c=document.querySelector(".username"),d=a.data.user.reel.user.username;b.setAttribute("src","https://api.allorigins.win/raw?url="+encodeURIComponent(a.data.user.reel.user.profile_pic_url)),c.innerHTML="@"+d,f(d)}).catch(a=>{console.log(a)})}function f(a){fetch("https://www.instagram.com/"+a+"/?__a=1").then(a=>a.json()).then(a=>{const b=a.graphql.user.edge_owner_to_timeline_media.edges;let c="";b.forEach(a=>{c+="<div class=\"post\" data-shortcode=\""+a.node.shortcode+"\" style=\"background-image:url(https://api.allorigins.win/raw?url="+encodeURIComponent(a.node.thumbnail_resources[1].src)+")\"><div class=\"overlay\"><div class=\"comments\"><svg class=\"icon\"><use xlink:href=\"#comment\"></use></svg><span>"+a.node.edge_media_to_comment.count.toLocaleString()+"</span></div></div></div>"}),r.innerHTML=c,u.parentElement.style.display="none",s.style.display="block"}).catch(a=>{console.log(a)})}function g(d){function e(a){a<=g||100<=a||(i.innerHTML=a+"%",i.style.width=a+"%",g=a)}async function f(g=""){await a();fetch("https://www.instagram.com/graphql/query/?query_hash=bc3296d1ce80a24b1b6e40b1e72903f5&variables={\"shortcode\":\""+d+"\",\"first\":50,\"after\":"+JSON.stringify(g)+"}",{method:"GET",headers:q}).then(a=>{if(200!=a.status)if(o++,10>o)throw console.log(o),setTimeout(()=>{f(g)},1e4*o),"Trying again...";else throw alert("Parece que o Instagram est\xE1 bloqueando a requisi\xE7\xE3o, tente novamente mais tarde."),"Stopped by Instagram, please try again later!";return a.json()}).then(a=>{const d=a.data.shortcode_media.edge_media_to_parent_comment.page_info.end_cursor,g=a.data.shortcode_media.edge_media_to_parent_comment.page_info.has_next_page,l=a.data.shortcode_media.edge_media_to_parent_comment.edges;let m=0;l.forEach(a=>{m+=b({text:a.node.text,username:a.node.owner.username,picture:a.node.owner.profile_pic_url})}),0==m&&10<l.length&&p++,w.scrollTop=w.scrollHeight,h.innerHTML=c(Math.floor((j.comment_count-j.comments.length)/50)),k.innerHTML="Toplam Yorum: "+j.comments.length.toLocaleString();let n=Math.round(100*(j.comments.length/j.comment_count));e(n),g&&5>=p?f(d):(h.innerHTML="İşlem Tamamlandı",i.parentElement.style.display="none",document.querySelector(".options-block").style.display="block")}).catch(a=>{console.log(a)})}s.style.display="none",u.parentElement.style.display="block";let g=0,h=t.querySelector("#timeleft"),i=t.querySelector(".progress"),k=t.querySelector("#loaded");fetch("https://www.instagram.com/graphql/query/?query_hash=63f18614a3a628db10bb6738df1b6e8a&variables={\"shortcode\":\""+d+"\"}").then(a=>a.json()).then(a=>{u.parentElement.style.display="none",j={shortcode:d,username:a.data.shortcode_media.owner.username,picture:a.data.shortcode_media.display_resources[0].src,comment_count:a.data.shortcode_media.edge_media_to_comment.count,comments:[]};let b=t.querySelector("img");b.setAttribute("src","https://api.allorigins.win/raw?url="+encodeURIComponent(j.picture)),t.querySelector("#user").innerHTML="@"+j.username,t.style.display="block",h.innerHTML=c(Math.floor(j.comment_count/50)),k.innerHTML="Yorum Sayısı: 0",e(5),f()}).catch(a=>{console.log(a)})}function h(){let a=Math.floor(Math.random()*j.comments.length),b=j.comments[a];k.push(b);let c="";k.forEach((a,b)=>{c+="<div class=\"result-item\"><div class=\"text-sm\">"+(b+1)+". KAZANAN</div><div class=\"mt-1\"><span class=\"font-semibold\">"+a.username+"</span>: "+a.text+"</div></div>"}),A.innerHTML=c,setTimeout(()=>{A.style.display="block"},500);let e=new Date;v.querySelector(".winner-date").innerHTML=e.toLocaleString(),v.querySelector(".winner-num").innerHTML=k.length,v.querySelector(".winner-username").innerHTML="@"+b.username,v.querySelector(".winner-comment").innerHTML="Yorum: "+b.text,v.querySelector(".winner-picture").setAttribute("src","https://api.allorigins.win/raw?url="+encodeURIComponent(b.picture)),confetti.maxCount=90,confetti.alpha=.75,confetti.start(),v.classList.add("overlay-open")}let i=0,j={},k=[],l="loading",m=new URLSearchParams(window.location.search),n=m.get("shortcode"),o=0,p=0,q={"x-csrftoken":"","x-requested-with":"XMLHttpRequest","x-ig-app-id":"936619743392459"},r=document.querySelector(".posts"),s=document.querySelector(".step1"),t=document.querySelector(".step2"),u=document.querySelector(".status-info"),v=document.querySelector(".result-overlay"),w=document.querySelector(".comments-area"),x=document.getElementById("urlButton"),y=document.getElementById("urlInput"),z=document.getElementById("playButton"),A=document.getElementById("results"),B=document.getElementById("close-link");x.addEventListener("click",function(){let a=y.value,b=a.match(/(?<=\/p\/)[\w-]+/i);return b?void(window.location="?shortcode="+b[0]):void alert("Geçersiz Link")}),z.addEventListener("click",h),B.addEventListener("click",function(a){a.preventDefault(),confetti.stop(),v.classList.remove("overlay-open")}),r.addEventListener("click",function(a){a.target&&a.target.closest(".post")&&(n=a.target.closest(".post").getAttribute("data-shortcode"),window.location="?shortcode="+n)}),chrome.cookies.get({url:"https://www.instagram.com/",name:"ds_user_id"},function(a){a?(l="logged_in",i=a.value,chrome.cookies.get({url:"https://www.instagram.com/",name:"csrftoken"},function(a){q["x-csrftoken"]=a.value})):l="logged_out",d()})},!1);